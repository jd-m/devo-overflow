<head>
   
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="jquery-3.6.0.min.js"></script>
  <script>

  </script>
  <link rel="stylesheet" href="site.css">
</head>

<div class="header col-12 test">
  <a href="./index.html">
  <h1 class="center">Devo_Overflow</h1>
  <div class="triple-line">
    <hr style="margin-left:40%; margin-right:40%;">
    <hr style="margin-left:45%; margin-right:45%;">
    <hr style="margin-left:48%; margin-right:48%;">
    </a>

  </div>
</div>
<div class="col-2">
</div>
<div  class="col-7 test content center">
  <h2>Posts</h2>
  <div id="posts"></div>
  <script>
    function makeArticleCard(file) {
        $.get(file, function (data) {
            $('#posts').append(
                              "<hr>" +
              "<a href=\"" + file + "\">" +
              "<div class=\"card center\">" + 
              "<h4 style=\"\">" + $(data).find("#title").html() + "</h4>" +
                  "<h5 class=\"disappear\">" + $(data).find("#subtitle").html() + "</h5>" +
                  "<p class=\"date\"><i>" + $(data).find("#date").html() + "</i></p>" +
                  "<p class=\"disappear\">" + $(data).find("p").text().substring(0,200) + "..." + "</p>" +
                  "</div>" + 
                  "</a>"
                  );
      });  
    }

    var pageIndex = 0, pageIncrement = 2, numArticles = 4;

    $.getJSON('./article-db.json',function(data) {
        
        numArticles = data.articles.length;
    });
        
    function updatePosts() {
        $('#posts').empty();
        
        $.getJSON('./article-db.json',function(data) {
            var jd;
            jd = data.articles;
            jd.sort(function(a,b) {
                return a - b;
            });
                        
            for (let i = 0; i < pageIncrement; i++){
                let articleFile = jd[pageIndex + i].file;
                if (articleFile !== undefined) {
                    makeArticleCard('articles/' + articleFile);
                }
            }        
        });
        
        window.scrollTo(0,0);
    }


    
    function incPageIndex(inc) {
        let newPageIndex = Math.min(Math.max(pageIndex + inc, 0), numArticles);
        pageIndex = newPageIndex;
    }
    
    function nextPage(){
        let prevPageIndex = pageIndex;
        incPageIndex(pageIncrement);
        if (prevPageIndex !== pageIndex) {
            updatePosts();
        }
        
        if ((pageIndex + pageIncrement) >= numArticles) {
            $('#nextButton').prop('disabled', true);
        }
            
        if ($('#prevButton').prop('disabled') == true) {
            $('#prevButton').prop('disabled', false)
        }
            
    }

    function prevPage(){
        let prevPageIndex = pageIndex;
        incPageIndex(pageIncrement * -1);
        if (prevPageIndex !== pageIndex) {
            updatePosts();
        }

        if ((pageIndex - pageIncrement) <= 0) {
            $('#prevButton').prop('disabled', true);
        }
        
        if ($('#nextButton').prop('disabled') == true) {
            $('#nextButton').prop('disabled', false);
        }
    }

    updatePosts();
    </script>
 <!--   <div class="card center">
    <h4>Title</h4>
    <h5>subtitle</h5>
    <p ="date">00 Month Year</p>
    <p>Content</p>
  </div> -->
  
<button id="prevButton" class="pagebutton" onclick="prevPage()" >Previous</button>
<button id="nextButton" class="pagebutton" style="float: right"  onclick="nextPage()" >Next</button>
<script>
    //Initial Button State
    if ((pageIndex + pageIncrement) >= numArticles) {
            $('#nextButton').prop('disabled', true);
    }
    if ((pageIndex - pageIncrement) <= 0) {
            $('#prevButton').prop('disabled', true);
    }
  </script>
</div>
<hr class="disappear">
<div class="side col-3 test">
  
  <h2>About</h2>
  <p> This blog is a place for some reflections on scripture, my faith, and how they inform life.</p>
    
</div>
<div class="footer" style="test"></div>
